---
title: 力扣数据库题目(1)
date: 2019-11-08 22:22:22
tags:
---
# 力扣（LeetCode）数据库题目

## 开始记录我在力扣所写的数据库题目

> 计划每天两题，写完免费的在开通会员去写付费题目
>
> 介绍每题的解法思路，以及对错，问题所在
>
> so，let's do this

### 题目1

~~~sql
编写一个 SQL 查询，获取 Employee 表中第二高的薪水（Salary） 。

+----+--------+
| Id | Salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
例如上述 Employee 表，SQL查询应该返回 200 作为第二高的薪水。如果不存在第二高的薪水，那么查询应返回 null。

+---------------------+
| SecondHighestSalary |
+---------------------+
| 200                 |
+---------------------+

来源：力扣（LeetCode）
链接：https://leetcode-cn.com/problems/second-highest-salary
著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。
~~~

### 个人解题思路

>首先第一个点，查询employee表中第二高的薪水，我马上就想到了distinct的去重，order by Salary desc以及limit的1,1查询第二条记录所以第一版本就是这样的

```sql
select distinct salary 
from Employee 
order by salary desc
limit 1,1
```

>当我提交上去，他给我报错？我看了一下要求结果要出现SecondHighestSalary字段 和如果为null要显示null？
>
>字段好说在salary 后面添加就行，但是为null这该怎么去写,不得其解。于是翻看解题思路，发现可以使用ifnull来进行判断，是我才疏学浅了
>
>那么我来介绍一下完整的思路及字段用法吧

### 网友解题思路

>首先先将数据去重
>再将是数据按薪水降序排除
>分页的思想是一页一条数据，第二高的薪水则在第二页
>考虑到极端情况：没有第二薪水则为空，使用ifnull判断

### 代码

```sql
SELECT IFNULL((
SELECT DISTINCT Salary 
FROM Employee 
ORDER BY Salary DESC 
LIMIT 1, 1
),null)
AS SecondHighestSalary
```

### 字段总结

>查询语句中的 limit 与 offset 的区别：
>
>DISTINCT去重，防止有多条数据时出现前两条都为最高薪水
>
>ORDER BY 排序，默认asc升序，此题使用desc降序
>
>limit的具体用法
>
>limit y 分句表示: 读取 y 条数据
>
>limit x, y 分句表示: 跳过 x 条数据，读取 y 条数据
>
>limit y offset x 分句表示: 跳过 x 条数据，读取 y 条数据

### 总结

>整体思路和我想的差不多，唯一的问题是我没有考虑到为null时使用的ifnull语句
>
>总的来说还是一道很简单的题目考点有三：
>
>1. distinct去重
>
>2. limit的具体用法 
>
>3. ifnull 的为null
>
>   以上